[2026-01-21 15:11:05,748][root][INFO] - Setting up matplotlib configuration
[2026-01-21 15:11:05,754][root][INFO] - Downloading Fama-French Size Breakpoints data...
[2026-01-21 15:11:06,442][root][INFO] - Fama-French Size Breakpoints data download complete to /home/rproner/Documents/Data/rsm3034_assignment1/download_cache/ff_size_breakpoints_20260121_201105.parquet.
[2026-01-21 15:11:06,443][root][INFO] - Downloading Fama-French 5 Factors Monthly data...
[2026-01-21 15:11:06,705][root][INFO] - Fama-French 5 Factors Monthly data download complete to /home/rproner/Documents/Data/rsm3034_assignment1/download_cache/ff5_monthly_20260121_201106.parquet.
[2026-01-21 15:11:06,706][root][INFO] - Downloading Compustat data...
[2026-01-21 15:12:00,099][root][INFO] - Compustat data download complete to /home/rproner/Documents/Data/rsm3034_assignment1/download_cache/compustat_20260121_201106.parquet.
[2026-01-21 15:12:00,099][root][INFO] - Downloading EKP HML data...
[2026-01-21 15:12:00,226][root][INFO] - EKP HML data download complete to /home/rproner/Documents/Data/rsm3034_assignment1/download_cache/ekp_hml_20260121_201200.parquet.
[2026-01-21 15:12:00,227][root][INFO] - Downloading CRSP Monthly Stock File data...
[2026-01-21 15:12:01,533][root][WARNING] - CRSP Monthly Stock File data download failed, skipping: (psycopg2.errors.UndefinedColumn) column msf.date does not exist
LINE 1: ...f.permno = ssih.permno AND ssih.secinfostartdt <= msf.date A...
                                                             ^

[SQL: SELECT msf.permno, msf.date, msf.ret, msf.shrout, msf.altprc, ssih.primaryexch, ssih.siccd FROM crsp.msf_v2 as msf INNER JOIN crsp.stksecurityinfohist AS ssih ON msf.permno = ssih.permno AND ssih.secinfostartdt <= msf.date AND msf.date <= ssih.secinfoenddt WHERE msf.date BETWEEN '19600101' AND '20241231' AND ssih.sharetype = 'NS' AND ssih.securitytype = 'EQTY' AND ssih.securitysubtype = 'COM' AND ssih.usincflg = 'Y' AND ssih.issuertype in ('ACOR', 'CORP') AND ssih.primaryexch in ('N', 'A', 'Q') AND ssih.conditionaltype in ('RW', 'NW') AND ssih.tradingstatusflg = 'A']
(Background on this error at: https://sqlalche.me/e/20/f405).
[2026-01-21 15:12:01,534][root][INFO] - CRSP Monthly Stock File data download complete to /home/rproner/Documents/Data/rsm3034_assignment1/download_cache/crsp_monthly_20260121_201200.parquet.
[2026-01-21 15:12:01,535][root][INFO] - Downloading CRSP-Compustat Link Table data...
[2026-01-21 15:12:03,771][root][INFO] - CRSP-Compustat Link Table data download complete to /home/rproner/Documents/Data/rsm3034_assignment1/download_cache/crsp_compu_link_table_20260121_201201.parquet.
[2026-01-21 15:12:03,773][root][INFO] - Building panel data...
[2026-01-21 15:12:03,773][root][INFO] - Loading CRSP data...
[2026-01-21 15:12:11,621][root][INFO] - Loading Compustat data...
[2026-01-21 15:12:32,644][root][INFO] - Creating size variable
[2026-01-21 15:12:32,895][root][INFO] - Creating book-to-market variables
[2026-01-21 15:12:34,333][root][INFO] - Assigning portfolios based on size, book-to-market, and intangible book-to-market
[2026-01-21 15:12:34,333][root][INFO] - Assigning portfolios based on size...
[2026-01-21 15:12:34,353][root][INFO] - Assigning portfolios based on bm...
[2026-01-21 15:12:34,371][root][INFO] - Assigning portfolios based on bm_int...
[2026-01-21 15:29:50,292][root][INFO] - Panel built. Shape: (770419, 18)
[2026-01-21 15:29:53,289][root][INFO] - Panel data saved to /home/rproner/Documents/Data/rsm3034_assignment1/clean/panel_data.parquet
[2026-01-21 15:29:57,975][root][INFO] - Loaded Fama-French data from /home/rproner/Documents/Data/rsm3034_assignment1/download_cache/ff5_monthly_20260121_201106.parquet
[2026-01-21 15:29:57,979][root][INFO] - Loaded EKP HML data from /home/rproner/Documents/Data/rsm3034_assignment1/download_cache/ekp_hml_20260121_201200.parquet
